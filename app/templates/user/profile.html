{% extends "base.html" %}

{% block title %}个人资料{% endblock %}

{% block content %}
    <div class="container-fluid">
        <h1 class="mt-4">个人资料</h1>
        <ol class="breadcrumb mb-4">
            <li class="breadcrumb-item active">个人资料</li>
        </ol>
        
        <!-- 消息提示 -->
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
                        {{ message }}
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                    </div>
                {% endfor %}
            {% endif %}
        {% endwith %}
        
        <!-- 个人资料卡片 -->
        <div class="row">
            <div class="col-md-6">
                <div class="card mb-4">
                    <div class="card-header">
                        <i class="bi bi-person-fill me-1"></i> 基本信息
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label class="form-label">用户名</label>
                            <div class="form-control-plaintext">{{ current_user.username }}</div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">昵称</label>
                            <div class="form-control-plaintext">{{ current_user.nickname or '未设置' }}</div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">邮箱</label>
                            <div class="form-control-plaintext">{{ current_user.email }}</div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">注册时间</label>
                            <div class="form-control-plaintext">{{ current_user.created_at.strftime('%Y-%m-%d %H:%M:%S') }}</div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">账号状态</label>
                            <div class="form-control-plaintext">
                                {% if current_user.is_active %}
                                    <span class="badge bg-success">正常</span>
                                {% else %}
                                    <span class="badge bg-danger">已停用</span>
                                {% endif %}
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">头像</label>
                            <div class="form-control-plaintext">
                                {% if current_user.avatar %}
                                    <img src="{{ current_user.avatar }}" alt="头像" width="100" height="100" class="rounded-circle">
                                {% else %}
                                    <i class="bi bi-person-circle" style="font-size: 3rem;"></i>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    <div class="card-footer">
                        <a href="{{ url_for('user_profile.edit_profile') }}" class="btn btn-primary">
                            <i class="bi bi-pencil-fill me-1"></i> 编辑资料
                        </a>
                        <a href="{{ url_for('user_profile.change_password') }}" class="btn btn-secondary">
                            <i class="bi bi-shield-lock-fill me-1"></i> 修改密码
                        </a>
                    </div>
                </div>
            </div>
            
            <!-- 快速链接 -->
            <div class="col-md-6">
                <div class="card mb-4">
                    <div class="card-header">
                        <i class="bi bi-link-45deg me-1"></i> 快速链接
                    </div>
                    <div class="card-body">
                        <div class="list-group">
                            <a href="{{ url_for('user_profile.login_history') }}" class="list-group-item list-group-item-action">
                                <i class="bi bi-clock-history me-2"></i> 登录历史记录
                            </a>
                            <a href="{{ url_for('user_profile.favorites') }}" class="list-group-item list-group-item-action">
                                <i class="bi bi-star-fill me-2"></i> 我的收藏夹
                            </a>
                            {% if current_user.is_admin() %}
                            <a href="{{ url_for('user_management.index') }}" class="list-group-item list-group-item-action">
                                <i class="bi bi-people-fill me-2"></i> 用户管理
                            </a>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}
